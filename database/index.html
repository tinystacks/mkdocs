
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://docs.tinystacks.com/database/" rel="canonical"/>
<link href="../assets/tinystacks.png" rel="icon"/>
<meta content="mkdocs-1.4.2, mkdocs-material-8.5.10" name="generator"/>
<title>Databases - TinyStacks Documentation</title>
<link href="../assets/stylesheets/main.975780f9.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.2505c338.min.css" rel="stylesheet"/>
<meta content="#000000" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PP279NG');
  </script>
<!-- End Google Tag Manager -->
</head>
<body data-md-color-accent="" data-md-color-primary="black" data-md-color-scheme="slate" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#changing-your-stacks-database-settings">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="TinyStacks Documentation" class="md-header__button md-logo" data-md-component="logo" href="https://www.tinystacks.com" title="TinyStacks Documentation">
<img alt="logo" src="../assets/tinystacks.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            TinyStacks Documentation
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Databases
            
          </span>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="TinyStacks Documentation" class="md-nav__button md-logo" data-md-component="logo" href="https://www.tinystacks.com" title="TinyStacks Documentation">
<img alt="logo" src="../assets/tinystacks.png"/>
</a>
    TinyStacks Documentation
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1">
          For App Developers
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="For App Developers" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
          For App Developers
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        Introduction
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2" id="__nav_1_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2">
          Get Started
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Get Started" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_2">
<span class="md-nav__icon md-icon"></span>
          Get Started
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../service-connections/">
        Configure AWS and Git service connections
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../create-stack/">
        Create your first stack
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../existing/">
        Deploy an existing application
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_4" id="__nav_1_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2_4">
          How It Works
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="How It Works" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_1_2_4">
<span class="md-nav__icon md-icon"></span>
          How It Works
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../architecture/">
        Architecture
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../concepts/">
        Concepts
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../security/">
        How we secure your stack
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../iam-policy/">
        Full AWS IAM Policy used by TinyStacks
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_5" id="__nav_1_2_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2_5">
          Features
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Features" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_1_2_5">
<span class="md-nav__icon md-icon"></span>
          Features
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../basic-settings/">
        Basic settings
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../builds-releases/">
        Builds, releases, and deployments
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../compute/">
        Compute
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../serverless/">
        Serverless
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../autoscaling/">
        Autoscaling
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../networking/">
        Networking
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Databases
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Databases
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#changing-your-stacks-database-settings">
    Changing your stack's database settings
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#adding-multiple-databases-to-a-stage">
    Adding multiple databases to a stage
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#connecting-to-your-database-from-your-application">
    Connecting to your database from your application
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#redis-support">
    Redis support
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#creating-a-read-replica">
    Creating a read replica
  </a>
<nav aria-label="Creating a read replica" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#creating-a-read-replica_1">
    Creating a read replica
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#connecting-to-your-replica-vs-connecting-to-your-primary">
    Connecting to your replica vs. connecting to your primary
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#using-a-bastion-host">
    Using a bastion host
  </a>
<nav aria-label="Using a bastion host" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#creating-a-bastion-host">
    Creating a bastion host
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#connecting-to-your-bastion-host">
    Connecting to your bastion host
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#accessing-your-databases-credentials-username-and-password">
    Accessing your database's credentials (username and password)
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../stages/">
        Stages
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../environment-variables/">
        Environment variables
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../load-balancers/">
        Load balancers
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../domain-names-https/">
        Domain names and HTTPS
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sidecars/">
        Sidecars
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../logging-monitoring/">
        Logging and monitoring
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../customizing/">
        Customizing your stacks
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../integrations/">
        Integrations with other systems
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../data-retention/">
        Data retention
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../integrations/">
        Integrating other DevOps services
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../connections-manage/">
        Managing service connections
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_6" id="__nav_1_2_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2_6">
          Troubleshooting
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Troubleshooting" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_1_2_6">
<span class="md-nav__icon md-icon"></span>
          Troubleshooting
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../troubleshooting/">
        Troubleshooting guide
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_2_7" id="__nav_1_2_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2_7">
          The TinyStacks Advantage
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="The TinyStacks Advantage" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_1_2_7">
<span class="md-nav__icon md-icon"></span>
          The TinyStacks Advantage
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../comparisons/">
        How TinyStacks stacks up
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../vendors/">
        For Vendors
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/">
        API Guide
      </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1>Databases</h1>
<p>TinyStacks supports creating one or more databases as part of your stack. You can also choose to pass in a database you have already created in your AWS account. </p>
<h2 id="changing-your-stacks-database-settings">Changing your stack's database settings</h2>
<p><a href="https://tinystacks.com/stacks/" target="_blank">Go to your Stacks page</a> and, for the stack you want to modify, click the gear icon in the lower right corner. This will open the <strong>Settings</strong> page. In the left hand column, under <strong>Stage</strong>, select the stage to which you want to add a database. Then, from the same column, select <strong>Database</strong>. </p>
<p>You will see two different screens here depending on whether your stage currently has a database or not. If it has a database, you will see a screen that enables you to change the instance type for your database as well as the amount of disk storage used. </p>
<p><img alt="TinyStacks - change database settings for a stack" src="../img/tinystacks-database-1.png"/></p>
<p>If your stage currently has no database, you will see the following screen. You can either add a new Postgres, MySQL, or Redis database. You can also add another existing AWS database to your stack. </p>
<p><img alt="TinyStacks - change database settings for a stack" src="../img/tinystacks-database-2.png"/></p>
<p><em>Note</em>: Saving your changes will trigger a rebuild of your stage. Your application may not be accessible on this stage until the rebuild and redeploy has completed. </p>
<h2 id="adding-multiple-databases-to-a-stage">Adding multiple databases to a stage</h2>
<p>You can add multiple databases to a stage once it is created. You can add one instance apiece of a Postgres, MySQL, or Redis database to each stage. </p>
<p>To add a new database to a stage, select your stack from the <strong>Your stacks</strong> dashboard to view all of its stages. From the <strong>Stages</strong> page, click the database icon for the stage where you will add your database. This will take you to the <strong>Databases</strong> settings page.</p>
<p><img alt="Select the databases for your stage" src="../img/select-stage-dbs.png"/></p>
<p>From the <strong>Databases</strong> page, click the <strong>+ Add database</strong> text to add a new database to the stack. </p>
<p><img alt="Add another database to a stage" src="../img/databases-add-multiple.png"/></p>
<p>On the <strong>Add a database</strong> dialog, select the database you wish to add from the supported types. </p>
<p><img alt="Add new database" src="../img/select-database-type.png"/></p>
<p>After you click <strong>Add database</strong>, TinyStacks will launch an update of your stack to create the new resource in your AWS account. </p>
<p><img alt="New database being added to your stage" src="../img/multiple-database-listing.png"/></p>
<h2 id="connecting-to-your-database-from-your-application">Connecting to your database from your application</h2>
<p>When you have TinyStacks create a database for you, we push all information about the database - including username and password - into a set of runtime variables. These are exposed to your application as environment variables in your Docker container instances. </p>
<p>If you create a Postgres database, the variables pushed include: </p>
<ul>
<li><strong>PG_HOST</strong>: The IP address</li>
<li><strong>PG_PORT</strong>: The port on which the Postgres database is running</li>
<li><strong>PG_CREDENTIALS_SECRET</strong>: The password for connecting to your Postgres database</li>
<li><strong>PG_DATABASE</strong>: The name of the database on the database host server</li>
</ul>
<p>For MySQL, the variables are:</p>
<ul>
<li><strong>MYSQL_HOST</strong>: The IP address</li>
<li><strong>MYSQL_PORT</strong>: The port on which your MySQL database is running</li>
<li><strong>MYSQL_CREDENTIALS_SECRET</strong>: The password for connecting to your MySQL database</li>
<li><strong>MYSQL_DATABASE</strong>: The name of the database on the database host server</li>
</ul>
<p>For Redis, the variables are: </p>
<ul>
<li><strong>REDIS_HOST</strong>: The IP address</li>
<li><strong>REDIS_PORT</strong>: The port on which your Redis database is running</li>
<li><strong>REDIS_CREDENTIALS_SECRET</strong>: The password for connecting to your Redis database</li>
<li><strong>REDIS_DATABASE</strong>: The name of the database on the database host server</li>
</ul>
<p>Your application code should be able to access these values the same as it would any other environment variable (e.g., <a href="https://nodejs.dev/learn/how-to-read-environment-variables-from-nodejs" target="_blank"><code>process.env</code> in Node.js</a> or <a href="https://www.nylas.com/blog/making-use-of-environment-variables-in-python/" target="_blank"><code>os.environ.get()</code> in Python</a>).</p>
<h2 id="redis-support">Redis support</h2>
<p>TinyStacks supports adding a Redis database to your stages. </p>
<p>Redis is an in-memory key-value store that provides rapid access to cached data. Using an in-memory database is a common design pattern that enables applications to access data without repeated reads to a disk-based database. This reduces congestion on your database, which in turn increases request response times and reduces the risk of database timeouts during high-traffic periods. Your application can also use an in-memory database to store calculated values (e.g., a user's Most Recently Used list) that can be accessed safely by multiple nodes in your application cluster.</p>
<p>TinyStacks creates a Redis instance in your AWS account using <a href="https://aws.amazon.com/elasticache/redis/" target="_blank">AWS ElastiCache for Redis</a>.</p>
<h2 id="creating-a-read-replica">Creating a read replica</h2>
<p>When you <a href="../stages/">add a new stage</a> to a stack, you have the option of adding a read replica, a read-only version of your database. </p>
<p>Read replicas are useful for offloading read activity from your main database. The majority of Web applications see far more data reads than they do data writes. (Consider how many people browse a product catalog versus actually making a purchase.) By offloading reads, you reduce the risk of overloading your primary database and improve overall application performance and stability. </p>
<p>Read replicas can also help with application performance. By placing read replicas in different AWS regions, you can reduce latency between your application and database. </p>
<p>Finally, you can promote a read replica to primary in the event your primary suffers a service disruption (e.g., the Availability Zone hosting it becomes unavailable). This helps ensure continuity of business.</p>
<p>Read replicas are only available for Postgres and MySQL databases.</p>
<p>For more information on read replicas on AWS, <a href="https://aws.amazon.com/rds/features/read-replicas/" target="_blank">see the documentation on AWS's web site</a>. </p>
<h3 id="creating-a-read-replica_1">Creating a read replica</h3>
<p>You can create a read replica in every new stage in a stack. Read replicas can exist in any AWS region supported by TinyStacks. For example, if your application serves the US market primarily, you could create your main production stack in us-east-2 and then a regional deployment with a read replica in us-west-2. If you then expand to the Asia market, you could create another regional deployment with read replica in ap-northeast-1. </p>
<p>To add a read replica to a stack, navigate to your stack and click the <strong>New stage</strong> button. On the New Stage dialog, you'll have the option to create a database for the stage. Select <strong>Read Replica</strong>.</p>
<p><img alt="TinyStacks - add read replica" src="../img/add-read-replica.png"/></p>
<h3 id="connecting-to-your-replica-vs-connecting-to-your-primary">Connecting to your replica vs. connecting to your primary</h3>
<p>To effectively use read replicas, your application will need to route database requests to the appropriate endpoint. To enable this, TinyStacks adds an additional set of runtime variables to your application's Docker container. These are <code>PG_READER_HOST</code> and <code>PG_READER_PORT</code> for a PostgreSQL database and <code>MYSQL_READER_HOST</code> and <code>MYSQL_READER_PORT</code> for a MySQL database. </p>
<p>You will then need to alter your application code to be aware of the replica and route read operations to it. How you do this will differ based on what application framework you use. Some packages, such as the ORM library Sequelize, <a href="https://sequelize.org/docs/v6/other-topics/read-replication/" target="_blank">have built-in support for read replicas</a>.</p>
<h2 id="using-a-bastion-host">Using a bastion host</h2>
<p>By default, your database is only accessible <a href="../networking/">from the same VPC</a> in which your application runs. However, many teams will want to connect directly to their databases to run queries with tools like MySQL Workbench. </p>
<p>To enable these scenarios, you need to create <a href="https://aws.amazon.com/premiumsupport/knowledge-center/rds-connect-using-bastion-host-linux/" target="_blank">a <strong>bastion host</strong></a>. The bastion host is an Amazon EC2 instance that sits in your VPC and creates a secure SSH tunnel so you can connect to your database. The SSH connection requires using public key cryptography, which prevents unauthorized users from connecting to your bastion and attempting to access your database. </p>
<h3 id="creating-a-bastion-host">Creating a bastion host</h3>
<p>You can create a bastion host when you initially launch your stack and configure your database. If you didn't add a database to your stack yet, you can navigate to Stack Settings for your stack and add it under <strong>Stage settings</strong> -&gt; <strong>Database</strong>.</p>
<h3 id="connecting-to-your-bastion-host">Connecting to your bastion host</h3>
<p>To connect to your database, navigate to your stack's <strong>Stack settings</strong> page. Under <strong>Stage settings</strong> -&gt; <strong>Database</strong>, you'll see a box labeled <strong>Bastion connection information</strong>. Here, you can download the private key you'll need to connect to your database. </p>
<p><img alt="TinyStacks - see secrets for Postgres" src="../img/db-bastion-key-download.png"/></p>
<p>Once downloaded, place your private key somewhere on your computer where you can reference it easily. Make sure you secure the machine on which the private key exists; anyone with access to this key and your bastion's connection information could use this to attempt to gain access to your database. </p>
<p>The ssh command provided doesn't connect you directly to the bastion. Rather, it connects you to your database, using the bastion host as a tunnel. The various arguments to the command have the following meaning: </p>
<ul>
<li><code>-i</code>: Ensures the connection is made using a private key that matches to a public key on the server.</li>
<li><code>-L</code>: Designates the connection as a tunnel. The argument specifies a localhost port, the bastion endpoint, and the port on the RDS database. This port will differ if you use different database systems (5432 for Postgres, 3306 for MySQL, etc.). </li>
<li><code>-f</code>: Forces the SSH connection into the background. </li>
<li><code>-N</code>: Prohibits remote command execution on the bastion - the connection can only forward commands to the Amazon RDS database. </li>
</ul>
<p>After you open this tunnel, you can use your sql client or CLI to connect to the database using the credentials found in AWS Secrets Manager (see below). Instead of using the RDS endpoint as host, you specify <code>localhost</code>. </p>
<p>If you prefer to use a visual tool, like MySQL Workbench, <a href="https://dev.mysql.com/doc/workbench/en/wb-mysql-connections-methods-ssh.html" target="_blank">you can configure the tool to connect to your database via an SSH tunnel</a> using your connection information and your SSH private key. Consult your tool's documentation for detailed constructions on configuring SSH tunnels.</p>
<h3 id="accessing-your-databases-credentials-username-and-password">Accessing your database's credentials (username and password)</h3>
<p>You will, of course, still need your database's username and password to connect to it!</p>
<p>Your database username and password are stored securely in your AWS account using <a href="https://console.aws.amazon.com/secretsmanager/" target="_blank">AWS Secrets Manager</a>. You can see these secrets by navigating to AWS Secrets Manager in your AWS account. </p>
<p><img alt="TinyStacks - see secrets for Postgres" src="../img/tinystacks-secrets-1.png"/></p>
<p>You can identify the correct secret for your application from the AWS Console in two ways: </p>
<ul>
<li>The <strong>Secret description</strong> of the stack, which will contain the name you gave your stack at stack creation time. </li>
<li>The tag <strong>aws:cloudformation:stack-name</strong>, which will also contain the name of your secret. </li>
</ul>
<p>If you have multiple stages, you will have multiple secrets. You can distinguish them by the name of the secret, which will have the name of the stage pre-pended. In this example, since this is our database for our dev stage, it starts with the prefix <code>dev</code>. </p>
<p>In the AWS Console, you can see the information stored in this secret by expanding the <strong>Secret value</strong> dropdown. There, you can see all of the information required to connect to your database. </p>
<p><img alt="TinyStacks - expand secret values for Postgres" src="../img/tinystacks-secrets-2.png"/></p>
<p>If you need to retrieve these values programmatically, you can do so using the AWS Command Line Interface (CLI) or any of the APIs available for programmatic access. For example, using the AWS CLI, you can retrieve the secret you need by searching for all secrets where the tag <code>aws:cloudformation:stack-name</code> matches your stack name. You can then use the command <code>jq</code> to filter out the return values to get the correct database for your stage. </p>
<pre><code>aws secretsmanager list-secrets --region us-east-1 --filters Key=tag-key Values=aws:cloudformation:stack-name Key=tag-value,Values=test-django2 | jq '.[][] | select(.Name|test("^dev"))
</code></pre>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Networking" class="md-footer__link md-footer__link--prev" href="../networking/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Networking
            </div>
</div>
</a>
<a aria-label="Next: Stages" class="md-footer__link md-footer__link--next" href="../stages/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Stages
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
</div>
<div class="md-social">
<a class="md-social__link" href="https://www.tinystacks.com" rel="noopener" target="_blank" title="www.tinystacks.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40h-16c-1.1 0-2.2 0-3.3-.1-1.4.1-2.8.1-4.2.1H392c-22.1 0-40-17.9-40-40v-88c0-17.7-14.3-32-32-32h-64c-17.7 0-32 14.3-32 32v88c0 22.1-17.9 40-40 40h-55.9c-1.5 0-3-.1-4.5-.2-1.2.1-2.4.2-3.6.2h-16c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9.1-2.8v-69.6H32c-18 0-32-14-32-32.1 0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7l255.4 224.5c8 7 12 15 11 24z"></path></svg>
</a>
<a class="md-social__link" href="https://www.youtube.com/channel/UC21VAvNozfMxrcappmJ8EBA" rel="noopener" target="_blank" title="www.youtube.com">
<svg viewbox="0 0 576 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg>
</a>
<a class="md-social__link" href="https://twitter.com/Tiny_Stacks" rel="noopener" target="_blank" title="twitter.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg>
</a>
<a class="md-social__link" href="https://www.linkedin.com/company/tinystacks" rel="noopener" target="_blank" title="www.linkedin.com">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg>
</a>
<a class="md-social__link" href="https://github.com/tinystacks" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</a>
<a class="md-social__link" href="mailto:support@tinystacks.com" rel="noopener" target="_blank" title="">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l217.6 163.2c11.4 8.5 27 8.5 38.4 0l217.6-163.2c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48H48zM0 176v208c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V176L294.4 339.2a63.9 63.9 0 0 1-76.8 0L0 176z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": ["toc.integrate", "toc.expand"], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
<script src="../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
</body>
</html>