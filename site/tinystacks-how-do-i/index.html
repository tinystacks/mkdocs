
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://docs.tinystacks.com/tinystacks-how-do-i/">
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.4">
    
    
      
        <title>How Do I...? - TinyStacks Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.db9e7362.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#basic-how-do-i" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="TinyStacks Documentation" class="md-header__button md-logo" aria-label="TinyStacks Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TinyStacks Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              How Do I...?
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="TinyStacks Documentation" class="md-nav__button md-logo" aria-label="TinyStacks Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    TinyStacks Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Get Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Get Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Get Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../create-stack/" class="md-nav__link">
        Create Your First Stack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../existing/" class="md-nav__link">
        Deploy an Existing Application
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          How It Works
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="How It Works" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          How It Works
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        Architecture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/" class="md-nav__link">
        Concepts
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          How Do I...?
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        How Do I...?
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basic-how-do-i" class="md-nav__link">
    Basic How Do I
  </a>
  
    <nav class="md-nav" aria-label="Basic How Do I">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-a-new-stage" class="md-nav__link">
    ...add a new stage?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pass-custom-variables-and-configuration-data-to-each-stage" class="md-nav__link">
    ...pass custom variables and configuration data to each stage?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-my-scale-settings" class="md-nav__link">
    ...change my scale settings?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-my-stages-database-settings" class="md-nav__link">
    ...change my stage's database settings?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-to-my-postgres-database-from-my-application" class="md-nav__link">
    ...connect to my Postgres database from my application?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-a-stack" class="md-nav__link">
    ...delete a stack?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-a-stage" class="md-nav__link">
    ...delete a stage?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-how-do-i" class="md-nav__link">
    Advanced How Do I
  </a>
  
    <nav class="md-nav" aria-label="Advanced How Do I">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#change-the-exposed-port-for-my-application" class="md-nav__link">
    ...change the exposed port for my application?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-to-my-postgres-database-from-outside-of-my-application" class="md-nav__link">
    ...connect to my Postgres database from outside of my application?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pass-custom-data-to-the-build-process" class="md-nav__link">
    ...pass custom data to the build process?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-an-application-that-uses-a-framework-not-directly-supported-by-tinystacks" class="md-nav__link">
    ...deploy an application that uses a framework not directly supported by TinyStacks?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#push-custom-amazon-cloudwatch-logs-from-my-application" class="md-nav__link">
    ....push custom Amazon CloudWatch logs from my application?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#give-my-application-permission-to-access-other-aws-services" class="md-nav__link">
    ...give my application permission to access other AWS services?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          The TinyStacks Advantage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="The TinyStacks Advantage" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          The TinyStacks Advantage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../comparisons/" class="md-nav__link">
        How TinyStacks Stacks Up
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basic-how-do-i" class="md-nav__link">
    Basic How Do I
  </a>
  
    <nav class="md-nav" aria-label="Basic How Do I">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-a-new-stage" class="md-nav__link">
    ...add a new stage?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pass-custom-variables-and-configuration-data-to-each-stage" class="md-nav__link">
    ...pass custom variables and configuration data to each stage?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-my-scale-settings" class="md-nav__link">
    ...change my scale settings?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-my-stages-database-settings" class="md-nav__link">
    ...change my stage's database settings?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-to-my-postgres-database-from-my-application" class="md-nav__link">
    ...connect to my Postgres database from my application?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-a-stack" class="md-nav__link">
    ...delete a stack?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-a-stage" class="md-nav__link">
    ...delete a stage?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-how-do-i" class="md-nav__link">
    Advanced How Do I
  </a>
  
    <nav class="md-nav" aria-label="Advanced How Do I">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#change-the-exposed-port-for-my-application" class="md-nav__link">
    ...change the exposed port for my application?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-to-my-postgres-database-from-outside-of-my-application" class="md-nav__link">
    ...connect to my Postgres database from outside of my application?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pass-custom-data-to-the-build-process" class="md-nav__link">
    ...pass custom data to the build process?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-an-application-that-uses-a-framework-not-directly-supported-by-tinystacks" class="md-nav__link">
    ...deploy an application that uses a framework not directly supported by TinyStacks?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#push-custom-amazon-cloudwatch-logs-from-my-application" class="md-nav__link">
    ....push custom Amazon CloudWatch logs from my application?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#give-my-application-permission-to-access-other-aws-services" class="md-nav__link">
    ...give my application permission to access other AWS services?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>How Do I...?</h1>
                
                <p>So you've got your first stack up and running. Now, it's time to tailor your stack to meet your team's needs. The following guide addresses the most common use cases for maintaining and expanding your stack. </p>
<h2 id="basic-how-do-i">Basic How Do I</h2>
<h3 id="add-a-new-stage">...add a new stage?</h3>
<p>When TinyStacks created your stack, we created a single stage for you called <code>dev</code>. As discussed <a href="../concepts/">in our concepts documentation</a>, your team will likely want at least two stages - one for development and one for production. This allows you to test changes in your dev stage before releasing them to customers. </p>
<p>To add a second stage, <a href="https://tinystacks.com/stacks">navigate to your Stacks page</a> and select your stack by clicking on its name. </p>
<p><img alt="TinyStacks - select stack" src="../img/tinystacks-add-stage-1.jpg" /></p>
<p>The next page will show all of the stages currently defined for your stack. To add a new stage, click the <strong>Add stage</strong> button.</p>
<p><img alt="TinyStacks - add stage button" src="../img/tinystacks-add-stage-2.jpg" /></p>
<p>On the <strong>New stack stage</strong> screen, you can configure your new stage. In the next screenshot, we've supplied a sample dialog for a <code>prod</code> stage that we explain in detail below:</p>
<p><img alt="TinyStacks - add stack stage dialog" src="../img/tinystacks-add-stage-3.jpg" /></p>
<ul>
<li><strong>Stage name</strong>. Must be unique within this stack. Should indicate the role that this stage plays in your stack - e.g., dev, test, staging, prod, etc. In this case, we use the name <code>prod</code> to represent our production stage. </li>
<li><strong>Database</strong>. Enables adding a new Postgres database or another existing Amazon RDS database to your stack. For now, we'll leave this option blank.</li>
<li><strong>Require manual approval</strong>. By default, if a change checked into a branch is built and deployed successfully by one stage, it will propagate automatically to the next stage. In most cases, however, your team will want to test and approve changes manually before pushing them into production. Since we're creating a production stage here, we'll check this box. </li>
<li><strong>Amazon API Gateway vs. Application Load Balancer</strong>. Here, you can choose how you want to route requests to your application based on whether you expect your application will need to operate at standard scale or hyperscale. For now, we'll leave this to the default of Amazon API Gateway. For more information on scale settings, <a href="../architecture/">consult our architectural overview</a>.</li>
<li><strong>Enable caching</strong>. Whether to cache responses through API Gateway. This option is only available if using Amazon API Gateway. </li>
</ul>
<p>Once you've configured your stage to suit your needs, click <strong>Create new stage</strong>. The new stage will run and create, building the code that you most recently checked in to the stack's associated Git branch.</p>
<h3 id="pass-custom-variables-and-configuration-data-to-each-stage">...pass custom variables and configuration data to each stage?</h3>
<p>It's likely that your application will need various runtime variables set in order to run. For example, you may need to supply credentials to a data store, such as DynamoDB, or information on how to connect to other microservices on which the application depends. Each stage of your application will likely need its own custom runtime variables, as the configuration and the resources to which your application connects will vary by stage. </p>
<p>TinyStacks makes it easy to set runtime variables on your application that are unique to each stage. This enables you to have different configuration settings for your application depending on whether it's in dev, test, or production. </p>
<p>To add or change runtime variables, <a href="https://tinystacks.com/stacks/">go to your Stacks page</a>. For the stack you want to modify, click the gear icon in the lower right corner. </p>
<p><img alt="TinyStacks - change stage settings" src="../img/tinystacks-runtime-vars-1.jpg" /></p>
<p>In the <strong>Stage</strong> dropdown on the left hand navigation menu, make sure you select the stage of your stack that you want to modify. Then, to see your runtime variables, click <strong>Runtime variables</strong>.</p>
<p><img alt="TinyStacks - runtime variables configuration for stack" src="../img/tinystacks-runtime-vars-2.jpg" /></p>
<p><em>Note</em>: If you had TinyStacks create a database for your stage, you may already see some variables for connecting to your database defined here. </p>
<p>You can add any key-value pair you wish to your stage. When done, click <strong>Save runtime variables</strong> to save your changes. </p>
<p>Setting new runtime variables will trigger a rebuild of your stack's stage. Once the rebuild and redeploy is complete, the key-value pairs you defined will be exposed as environment variables on your Docker container. Your application code should be able to access these values the same as it would any other environment variable (e.g., <a href="https://nodejs.dev/learn/how-to-read-environment-variables-from-nodejs" target="_blank"><code>process.env</code> in Node.js</a> or <a href="https://www.nylas.com/blog/making-use-of-environment-variables-in-python/" target="_blank"><code>os.environ.get()</code> in Python</a>).</p>
<h3 id="change-my-scale-settings">...change my scale settings?</h3>
<p>When you create a stage, you can specify how you want your application to scale. If you need to change these at any time, you can do so through the stage's <strong>Settings</strong> page.</p>
<p><a href="https://tinystacks.com/stacks/">Go to your Stacks page</a> and, for the stack you want to modify, click the gear icon in the lower right corner. </p>
<p>You have two choices for adjusting scaling for your application. Click <strong>Endpoint</strong> to change how your application's endpoints are routed and load balanced on AWS. If you're currently using Amazon API Gateway but are beginning to handle more than 1 million requests/day, consider changing to Application Load Balancer instead.</p>
<p><img alt="TinyStacks - change endpoint settings" src="../img/tinystacks-change-scale-1.jpg" /></p>
<p>You may also desire to change how your Amazon ECS cluster scales. By default, TinyStacks will start two Amazon EC2 instances in your ECS cluster. We also define Amazon CloudWatch rules that implement the following behavior: </p>
<ul>
<li>If the aggregate CPU usage of your ECS cluster instances exceeds 75% for more than 15 minutes, AWS will automatically add another EC2 instances to the cluster. </li>
<li>If the aggregate CPU usage of your ECS cluster instances is lower than 75% for more than 15 minutes, AWS will automatically remove an EC2 instance from the cluster. </li>
</ul>
<p>You may need to change these defaults if your application is either using too many underutilized resources or (more likely) is maxing out on available ECS cluster instances. </p>
<p>To change scale settings, select <strong>Build and scale</strong> from the navigation menu on the <strong>Settings</strong> page. </p>
<p><img alt="TinyStacks - change ECS cluster scaling settings" src="../img/tinystacks-change-scale-2.jpg" /></p>
<p>Here, you can change several settings. The first is your application's <strong>instance sizing</strong>. You can upgrade instance sizing if you are spinning up new ECS cluster instances too quickly. If you are currently using a t3.micro instance size, consider upgrading to an m3.medium or an m3.large.</p>
<p>You can also adjust your <strong>autoscale min/max settings</strong>. The following settings are available to change: </p>
<p><strong>Desired capacity</strong></p>
<p>The number of ECS cluster instances to maintain if no auto scaling rules have been triggered by a CloudWatch alarm. </p>
<p>The desired capacity should be set to a level that cna sustain normal, everyday traffic. If you set it too high, you will spend additional money on ECS cluster instances you aren't using. Conversely, if you set it too high, you may experience service interruptions, as it can take several minutes to initialize a new cluster instance.</p>
<p><strong>Min Capacity</strong></p>
<p>The minimum number of cluster instances to run regardless of auto scaling rules. As stated above, scaling up a new cluster instance can take time; setting a minimum number of instances ensures you always have "warm" cluster instances that are stood up and able to accept incoming traffic. </p>
<p><strong>Max Capacity</strong></p>
<p>The maximum number of cluster instances to run regardless of auto scaling rules. This setting provides an upper boundary beyond which your application will not scale, which is  useful for controlling costs or responding to a potential denial of service attack. </p>
<p>For more information on scaling of EC2 instances, <a href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/asg-capacity-limits.html" target="_blank">see the AWS documentation</a>. </p>
<p><em>Note</em>: Saving settings changes will trigger a rebuild of your stage. Your application may not be accessible on this stage until the rebuild and redeploy has completed. Changing any of the settings in this section may result in increased AWS service costs. </p>
<h3 id="change-my-stages-database-settings">...change my stage's database settings?</h3>
<p><a href="https://tinystacks.com/stacks/">Go to your Stacks page</a> and, for the stack you want to modify, click the gear icon in the lower right corner. This will open the <strong><em>Settings</em>* page. In the left hand column, under </strong>Stage<strong>, select the stage to which you want to add a database. Then, from the same column, select </strong>Database**. </p>
<p>You will see two different screens here depending on whether your stage currently has a database or not. If it has a database, you will see a screen that enables you to change the instance type for your database as well as the amount of disk storage used. </p>
<p><img alt="TinyStacks - change database settings for a stack" src="../img/tinystacks-database-1.jpg" /></p>
<p>If your stage currently has no database, you will see the following screen. You can either add a new Postgres database, or add another existing AWS database to your stack. </p>
<p><img alt="TinyStacks - change database settings for a stack" src="../img/tinystacks-database-2.jpg" /></p>
<p><em>Note</em>: Saving your changes will trigger a rebuild of your stage. Your application may not be accessible on this stage until the rebuild and redeploy has completed. </p>
<p><img alt="TinyStacks - delete stack" src="../img/tinystacks-delete-1.jpg" /></p>
<h3 id="connect-to-my-postgres-database-from-my-application">...connect to my Postgres database from my application?</h3>
<p>When you have TinyStacks create a Postgres database for you, we push all information about the database - including username and password - into a set of runtime variables. These are exposed to your application as environment variables in your Docker container instances. </p>
<p>The variables pushed include: </p>
<ul>
<li><strong>PG_HOST</strong>: The IP address</li>
<li><strong>PG_PORT</strong>: The port on which the Postgres database is running</li>
<li><strong>PG_CREDENTIALS_SECRET</strong>: The password for connecting to your Postgres database</li>
<li><strong>PG_DATABASE</strong>: The name of the database on the database host server</li>
</ul>
<p>Your application code should be able to access these values the same as it would any other environment variable (e.g., <a href="https://nodejs.dev/learn/how-to-read-environment-variables-from-nodejs" target="_blank"><code>process.env</code> in Node.js</a> or <a href="https://www.nylas.com/blog/making-use-of-environment-variables-in-python/" target="_blank"><code>os.environ.get()</code> in Python</a>).</p>
<h3 id="delete-a-stack">...delete a stack?</h3>
<p>To delete a stack, <a href="https://tinystacks.com/stacks/">go to your Stacks page</a> and, for the stack you want to modify, click the gear icon in the lower right corner. This will land you on the <strong>Stack settings</strong> page. There, you will find a <strong>Delete</strong> button. Click it, and type <code>delete</code> in the dialog box when prompted to confirm the operation. </p>
<h3 id="delete-a-stage">...delete a stage?</h3>
<p>To delete a stack, <a href="https://tinystacks.com/stacks/">go to your Stacks page</a> and, for the stack you want to modify, click the gear icon in the lower right corner. This will land you on the <strong>Stack settings</strong> page. On the left hand navigation menu, under <strong>Stage settings</strong>, select the stage you want to delete. </p>
<p>After this, select the <strong>Stage details</strong> link on the left hand navigation menu. There, you will find a <strong>Delete Stage</strong> button. Click it and, when prompted, enter <code>delete</code> to confirm the operation. </p>
<p><img alt="TinyStacks - delete stage" src="../img/tinystacks-delete-stage-1.jpg" /></p>
<h2 id="advanced-how-do-i">Advanced How Do I</h2>
<h3 id="change-the-exposed-port-for-my-application">...change the exposed port for my application?</h3>
<p>TinyStacks needs to know which port your application is serving HTTP traffic over in order to configure your Amazon ECS tasks properly. If you are using a port besides the standard port 80, you will need to change it in TinyStacks. </p>
<p>To change your port, <a href="https://tinystacks.com/stacks/">go to your Stacks page</a>. For the stack you want to modify, click the gear icon in the lower right corner. On the <strong>Stack Settings</strong> page, under <strong>Port</strong>, input the number of the port on which your Docker container is exposing its services.</p>
<p><img alt="TinyStacks - change port" src="../img/tinystacks-port-1.jpg" /></p>
<h3 id="connect-to-my-postgres-database-from-outside-of-my-application">...connect to my Postgres database from outside of my application?</h3>
<p>On top of pushing Postgres database connection information to your application as runtime variables, Tinystacks stores your credentials securely in your AWS account using <a href="https://console.aws.amazon.com/secretsmanager/" target="_blank">AWS Secrets Manager</a>. You can see these secrets by navigating to AWS Secrets Manager in your AWS account. </p>
<p><img alt="TinyStacks - see secrets for Postgres" src="../img/tinystacks-secrets-1.jpg" /></p>
<p>You can identify the correct secret for your application from the AWS Console in two ways: </p>
<ul>
<li>The <strong>Secret description</strong> of the stack, which will contain the name you gave your stack at stack creation time. </li>
<li>The tag <strong>aws:cloudformation:stack-name</strong>, which will also contain the name of your secret. </li>
</ul>
<p>If you have multiple stages, you will have multiple secrets. You can distinguish them by the name of the secret, which will have the name of the stage pre-pended. In this example, since this is our Postgres database for our dev stage, it starts with te prefix <code>dev</code>. </p>
<p>In the AWS Console, you can see the information stored in this secret by expanding the <strong>Secret value</strong> dropdown. There, you can see all of the information required to connect to your Postgres database. </p>
<p><img alt="TinyStacks - expand secret values for Postgres" src="../img/tinystacks-secrets-2.jpg" /></p>
<p>If you need to retrieve these values programmatically, you can do so using the AWS Command Line Interface (CLI) or any of the APIs available for programmatic access. For example, using the AWS CLI, you can retrieve the secret you need by searching for all secrets where the tag <code>aws:cloudformation:stack-name</code> matches your stack name. You can then use the command <code>jq</code> to filter out the return values to get the correct database for your stage. </p>
<pre><code>aws secretsmanager list-secrets --region us-east-1 --filters Key=tag-key Values=aws:cloudformation:stack-name Key=tag-value,Values=test-django2 | jq '.[][] | select(.Name|test(&quot;^dev&quot;))
</code></pre>
<h3 id="pass-custom-data-to-the-build-process">...pass custom data to the build process?</h3>
<p>Your <code>build.yml</code> file controls how your container is built and then stored in Amazon ECR. Sometimes, you may need to pass custom data at build time when building your Docker image. You can accomplish this by defining build variables for your stack. </p>
<p>To define build variables, <a href="https://tinystacks.com/stacks/">go to your Stacks page</a>. For the stack you want to modify, click the gear icon in the lower right corner. On the <strong>Stack Settings</strong> page, click <strong>Build variables</strong>. Here you can define name-value pairs that you can refernece in your <code>build.yml</code> file. </p>
<p><img alt="TinyStacks - build variables" src="../img/tinystacks-build-variables-1.jpg" /></p>
<h3 id="deploy-an-application-that-uses-a-framework-not-directly-supported-by-tinystacks">...deploy an application that uses a framework not directly supported by TinyStacks?</h3>
<p>While TinyStacks contains sample code for several popular application frameworks, our service is framework-agnostic. So long as your application can be packaged into a Docker container, it can run on TinyStacks!</p>
<h3 id="push-custom-amazon-cloudwatch-logs-from-my-application">....push custom Amazon CloudWatch logs from my application?</h3>
<p>By default, TinyStacks creates a CloudWatch Logs log group for you. Any application output written to standard output (e.g., <code>console.log()</code> in Node.js) will appear in this log. </p>
<h3 id="give-my-application-permission-to-access-other-aws-services">...give my application permission to access other AWS services?</h3>
<p>As you grow your application, you will likely want to incorporate access to other AWS services. Common examples include DynamoDB for NoSQL data storage and Amazon S3 for storing blobs and other large data. </p>
<p>Currently, there are two ways to do this on TinyStacks. Note that both operations require knowledge of AWS Identity and Access Management (IAM). </p>
<p><strong>Pass AWS credentials as runtime variables</strong></p>
<p>You can create an AWS access key and secret key and pass these variables as runtime variables as described above in <a href="#pass-custom-variables-and-configuration-data-to-each-stage">passing runtime variables to a stage.</a></p>
<p>Note that, if you do this, anyone with access to your TinyStacks account has access to these variables, and thus to your underlying AWS account. Please proceed with caution. </p>
<p><strong>Modify the IAM role for your application</strong></p>
<p>Your Amazon ECS tasks all run with an IAM task role that determines their AWS permissions. The task role name is a combination of the stack name, the stage name, and the phrase "TaskRoleDefaultPolicy". For example, below is the IAM role for the dev stage for a stack named <code>test-django2</code>. </p>
<p><img alt="TinyStacks - editing your IAM role" src="../img/tinystacks-iam-role-1.jpg" /></p>
<p>By default, this role only has permission to push events to your Amazon CloudWatch Logs log group. You can modify it with a valid IAm policy to grant it access to additional AWS resources. </p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../concepts/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Concepts" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Concepts
            </div>
          </div>
        </a>
      
      
        
        <a href="../comparisons/" class="md-footer__link md-footer__link--next" aria-label="Next: How TinyStacks Stacks Up" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              How TinyStacks Stacks Up
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.1e84347e.min.js"></script>
      
    
  </body>
</html>